$domain = ([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Name
$searcher = New-Object DirectoryServices.DirectorySearcher
$searcher.Filter = "(objectCategory=person)"
$searcher.PropertiesToLoad.Add("samaccountname") > $null
$results = $searcher.FindAll()
$results | ForEach-Object { $_.Properties.samaccountname }
